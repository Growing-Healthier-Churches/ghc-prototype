!function(r){"use strict";var i=function(t,a){this.container=r(void 0===t?"body":t),this.data=null,this.xhr=null,this.xhr_cache=[],this.id=this.container.find(".split-container").data("id"),this.init()};i.DEFAULTS={},i.prototype.init=function(){var t=this;void 0!==window[t.id]&&(t.data=window[t.id],t.data.index=parseInt(t.data.index),t.menu_drop(),"all"===t.data.mode||"ajax"===t.data.mode?t.mode_load_all():t.mode_normal(),r(window).on("popstate",r.proxy(t.popstate,t)),r(window).on("after_split_content_ajax",r.proxy(t.after_ajax,t)))},i.prototype.after_ajax=function(){r(document).trigger("split-post-ajax",[this.container])},i.prototype.menu_drop=function(){var t=this.container.find(".jeg_splitpost_bar");t.find(".jeg_splitpost_nav").length&&t.each(function(){var a=r(this);a.find(".nav_wrap"),a.find(".jeg_splitpost_nav");a.find(".current_title").on("click",function(){t.not(a).removeClass("nav-open"),a.toggleClass("nav-open")}),r(document).mouseup(function(t){a.hasClass("nav-open")&&0<!r(t.target).parents(".nav_wrap").length&&a.removeClass("nav-open")})})},i.prototype.mode_normal=function(){this.container.find(".page_nav.disable").on("click",function(t){t.preventDefault()})},i.prototype.mode_load_all=function(){var e=this;e.container.find(".split-container").hasClass("has-half-content")&&e.container.find(".split-carousel").on("initialized.owl.carousel",function(){r(this).find(".split-wrapper").each(function(){var t=r(this),a=t.find(".split-image > img");0<a.length&&a.width()<a.height()&&t.addClass("split-half-content")})}),e.container.find(".split-carousel").owlCarousel({items:1,nav:!(!e.container.find(".split-carousel").hasClass("has-nav-content")&&"17"!==e.data.type)&&"true",navText:!1,margin:30,startPosition:e.data.index,autoHeight:!0,onChanged:function(t){var a=t.item.index;null===a&&(a=e.data.index),e.change_slide(a,!0)}}),e.container.find(".jeg_splitpost_nav a").on("click",function(t){t.preventDefault();var a=r(this).parents(".jeg_splitpost_bar");r(a).removeClass("nav-open");var n=r(this).data("id");e.change_slide(n,!0)}),e.container.find(".jeg_split_pagination .page_number").on("click",function(t){t.preventDefault();var a=r(this).data("id");e.change_slide(a,!0)}),e.container.find(".jeg_split_pagination .page_nav, .jeg_bottomnav .page_nav, .jeg_splitpost_bar .page_nav").on("click",function(t){t.preventDefault();r(this).hasClass("prev")?e.change_slide(e.data.index-1,!0):e.change_slide(e.data.index+1,!0)})},i.prototype.popstate=function(t){if(void 0!==t.originalEvent){var a=t.originalEvent.state;a&&"split"===a.type&&this.change_slide(a.id,!1)}},i.prototype.change_slide=function(t,a){var n=this;t<0&&(t=0),t>n.data.max&&(t=n.data.max),n.data.index===t||(n.data.index=t,a&&n.change_url(t),n.change_title(t),"all"===n.data.mode?n.change_content(t):n.change_content_ajax(t),n.change_control(t),n.scroll_top(),r(window).trigger("resize"))},i.prototype.scroll_top=function(){var t=65;0<r("#wpadminbar").length&&(t+=32),r("html, body").stop().animate({scrollTop:this.container.find(".top-split-nav").offset().top-t},500)},i.prototype.change_title=function(t){var a=this.data.content[t];document.title=a.page_title},i.prototype.change_url=function(t){var a=this.data.content[t];a.type="split",history&&history.pushState&&history.pushState(a,"",a.url),r(document).trigger("split-change-url",[a.url,this.data.post_id])},i.prototype.change_content=function(t){var a=this;a.container.find(".split-wrapper").removeClass("active"),a.container.find(".split-wrapper[data-id='"+t+"']").addClass("active"),a.container.find(".split-carousel").trigger("to.owl.carousel",t,200)},i.prototype.cache_get=function(t){for(var a=this,n=0;n<a.xhr_cache.length;n++)if(a.xhr_cache[n].param===t.index)return a.xhr_cache[n].result;return!1},i.prototype.cache_save=function(t,a){this.xhr_cache.push({param:t.index,result:a})},i.prototype.process_content_ajax=function(t,a){this.container.find(".split-wrapper").html(a).removeClass("loading"),this.cache_save(t,a),r(document).trigger("after_split_content_ajax",[this.container.find(".split-wrapper")])},i.prototype.change_content_ajax=function(t){var a=this,n={post_id:a.data.post_id,type:a.data.mode,index:t,nonce:a.data.nonce};a.container.find(".split-wrapper").addClass("loading");var e=a.cache_get(n);e?a.process_content_ajax(n,e):(a.xhr=wp.ajax.send("split_post_handler",{data:n}),a.xhr.done(function(t){a.process_content_ajax.bind(a)(n,t)}))},i.prototype.change_control=function(t){var a=this,n=null,e=null,i=a.data.content[t];a.container.find(".jeg_splitpost_bar").each(function(){r(this).find(".jeg_splitpost_nav li").removeClass("current"),r(r(this).find(".jeg_splitpost_nav li").get(t)).addClass("current")}),a.change_nav_text(t);var o=a.data.page_text.replace("{page}",i.page);a.container.find(".jeg_split_pagination .page_info").text(o),a.container.find(".jeg_split_pagination .nav_link .page_number").removeClass("active"),a.container.find(".jeg_split_pagination .nav_link .page_number[data-id='"+t+"']").addClass("active"),a.container.find(".jeg_split_pagination .page_nav").removeClass("disabled"),0==t&&a.container.find(".jeg_split_pagination .page_nav.prev").addClass("disabled"),t==a.data.max&&a.container.find(".jeg_split_pagination .page_nav.next").addClass("disabled"),a.container.find(".jeg_bottomnav .page_nav").removeClass("hide"),0==t&&a.container.find(".jeg_bottomnav .page_nav.prev").addClass("hide"),t==a.data.max&&a.container.find(".jeg_bottomnav .page_nav.next").addClass("hide"),0<t&&(n=a.data.content[t-1],a.container.find(".jeg_bottomnav .page_nav.prev a").attr("href",n.url),a.container.find(".jeg_bottomnav .page_nav.prev strong").text(a.decode_string(n.title))),t<a.data.max&&(e=a.data.content[t+1],a.container.find(".jeg_bottomnav .page_nav.next a").attr("href",e.url),a.container.find(".jeg_bottomnav .page_nav.next strong").text(a.decode_string(e.title))),a.container.find(".jeg_splitpost_bar .page_nav").removeClass("disable"),0<t&&(n=a.data.content[t-1],a.container.find(".jeg_splitpost_bar .page_nav.prev a").attr("href",n.url)),t<a.data.max&&(e=a.data.content[t+1],a.container.find(".jeg_splitpost_bar .page_nav.next a").attr("href",e.url)),0==t&&a.container.find(".jeg_splitpost_bar .page_nav.prev").addClass("disable").find("a").attr("href","#"),t==a.data.max&&a.container.find(".jeg_splitpost_bar .page_nav.next").addClass("disable").find("a").attr("href","#")},i.prototype.decode_string=function(t){return(new DOMParser).parseFromString("<!doctype html><body>"+t,"text/html").body.textContent},i.prototype.change_nav_text=function(t){var a=this.data.content[t],n="<span class='pagenum'>"+a.page+".</span> "+a.title;this.container.find(".jeg_splitpost_bar .current_title").html(n)};var t=r.fn.jsplit;r.fn.jsplit=function(e){return r(this).each(function(){var t=r(this),a=r.extend({},i.DEFAULTS,t.data(),"object"==typeof e&&e),n=t.data("jeg.split");n||t.data("jeg.split",n=new i(this,a))})},r.fn.jsplit.Constructor=i,r.fn.jsplit.noConflict=function(){return r.fn.jsplit=t,this},r("body").jsplit()}(jQuery);